# https://github.com/ArveVM/HomeAssistantConfig4/blob/master/avm_yaml/packages/solutions/hastats.md
# card require Browser Mod v1.5.3
# works only in minimalist???  but can easily be re-worked to use other button-card template/method

type: "custom:button-card"
template: chip_icon_double_state
variables:
  ulm_chip_icon_double_state_icon: "ðŸš°"
  ulm_chip_icon_double_state_entity_1: sensor.hotwater_soc
  ulm_chip_icon_double_state_entity_2: sensor.hotwater_temperature

tap_action:
  action: fire-dom-event
  browser_mod:
    command: popup
    title: "Hotwater SoC:"
    large: false
    card:
      type: vertical-stack
      cards:
        - type: entities
          entities:
            - type: custom:fold-entity-row
              head:
                entity: sensor.hotwater_soc
                label: "SoC"
              open: false
              entities:
                - entity: sensor.hotwater_temperature
                  type: custom:multiple-entity-row
                  name: Temp
                  state_header: Current
                  secondary_info: last-changed
                  entities:
                    - entity: input_number.hotwater_soc_target_temp
                      name: Target
                    - entity: input_number.hotwater_soc_min_temp
                      name: Min
                - entity: sensor.hotwater_soc_chargetime
                - type: custom:fold-entity-row
                  head:
                    entity: sensor.hotwater_soc_energy_chargable
                    label: "toCharge"
                  open: false
                  entities:
                    - entity: sensor.hotwater_soc_energy_chargable
                      type: custom:multiple-entity-row
                      name: Energy
                      state_header: Charge
                      secondary_info: last-changed
                      entities:
                        - entity: sensor.hotwater_soc_energy_max
                          name: Max
                        - entity: sensor.hotwater_soc_energy_stored
                          name: Charged
                - type: custom:fold-entity-row
                  head:
                    type: section
                    label: SoC-settings
                  padding: 5
                  entities:
                    - input_number.hotwater_soc_target_temp
                    - input_number.hotwater_soc_min_temp
                    - input_number.hotwater_soc_input_temp
                    - input_number.hotwater_soc_tanksize
                    - input_number.hotwater_soc_elementsize
        - type: history-graph
          entities:
            - entity: switch.hotwater
            - entity: input_boolean.hotwater_thermostat_output
            - entity: sensor.hotwater_thermostat_mode
            - entity: sensor.hotwater_thermostat_target
            - entity: sensor.hotwater_temperature
              name: "Temp1-bottom"
            - entity: sensor.hotwater_temperature_2
              name: "Temp2-mix"

hold_action:
  action: navigate
  navigation_path: Workshop
